<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/web/template/innerLayout.xhtml">

    <ui:param name="paramBackBean" value="#{usuarioTerceroBackBean}"/>

    <ui:define name="headerContent">
        Usuarios
    </ui:define>
    <ui:define name="content" styleClass="ContainerIndent">
        <h:outputStylesheet name="css/leaflet.css" library="siit"/>
        <h:outputScript name="js/leaflet.js" library="siit"/>

        <h:outputScript name="plugins/LeafletExtraMarkers/src/assets/js/leaflet.extra-markers.js" library="siit"/>
        <h:outputStylesheet name="plugins/LeafletExtraMarkers/src/assets/css/leaflet.extra-markers.css" library="siit"/>

        <style type="text/css">
            @media (max-width: 1200px) and (min-width: 641px) {
                .Responsive {
                    width: 100% !important;
                }
            }

            #modalEmpresasDetalle .ui-dialog-titlebar {
                display: none;
            }

            .dialogSinBarraTitulo .ui-dialog-titlebar {
                display: none;
            }

            #modalPersonas .ui-dialog-titlebar {
                display: none;
            }

            #modalGraficoExpedientePorDelegacion .ui-dialog-titlebar {
                display: none;
            }

            #modalCantidadETporInspector .ui-dialog-titlebar {
                display: none;
            }

            #modalCapacidadInstaladaOVETTT .ui-dialog-titlebar {
                display: none;
            }

            #modalCapacidadInstaladaSA .ui-dialog-titlebar {
                display: none;
            }

            #modalConfirmacionEliminar .ui-dialog-titlebar {
                display: none;
            }

            #modalConfirmacionEnllavarDesenllavar .ui-dialog-titlebar {
                display: none;
            }

            .ui-selectonemenu label.ui-selectonemenu-label {
                text-transform: none !important;
            }

            input[disabled="disabled"], input[type="radio"], select[disabled="disabled"], textarea[disabled="disabled"] {
                background: bisque !important;
                color: black !important;
            }

            input[type="text"] {
                text-transform: none !important;
            }

            .ui-selectonemenu.ui-state-disabled .ui-selectonemenu-trigger, .ui-selectonemenu.ui-state-disabled .ui-selectonemenu-label {
                background: bisque !important;
                color: black !important;
            }

            .unselectable {
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }

            .alingCenter {
                text-align: center !important;
                font-weight: bold;
            }

            .enllavado {
                background: #f77979 !important;
            }

            .color-box {
                width: 15px;
                height: 15px;
                display: inline-block;
            }

            .ui-inputtextarea-resizable {
                text-transform: none !important;
            }

            /*slides*/
            /* Slideshow container */
            .slideshow-container {
                max-width: 1000px;
                position: relative;
                margin: auto;
                text-align: left;
            }

            .mySlides {
                display: none;
            }

            .prev {
                text-align: left !important;
            }

            /* Next and previous buttons */
            .prev, .next {
                cursor: pointer;
                position: absolute;
                top: 50%;
                width: auto;
                margin-top: -22px;
                padding: 16px;
                color: white;
                font-weight: bold;
                font-size: 18px;
                transition: 0.6s ease;
                border-radius: 0 3px 3px 0;
            }

            /* Position the "next button" to the right */
            .next {
                right: 0;
                border-radius: 3px 0 0 3px;
            }

            /* On hover, add a black background color with a little bit see-through */
            .prev:hover, .next:hover {
                background-color: rgba(0, 0, 0, 0.8);
            }

            /* Caption text */
            .text {
                color: #f2f2f2;
                font-size: 15px;
                padding: 8px 12px;
                position: absolute;
                bottom: 8px;
                width: 100%;
                text-align: center;
            }

            /* Number text (1/3 etc) */
            .numbertext {
                color: #f2f2f2;
                font-size: 12px;
                padding: 8px 12px;
                position: absolute;
                top: 0;
            }

            /* The dots/bullets/indicators */
            .dot {
                cursor: pointer;
                height: 13px;
                width: 13px;
                margin: 0 2px;
                background-color: #bbb;
                border-radius: 50%;
                display: inline-block;
                transition: background-color 0.6s ease;
            }

            .active, .dot:hover {
                background-color: #717171;
            }

            /* Fading animation */
            .fade {
                -webkit-animation-name: fade;
                -webkit-animation-duration: 1.5s;
                animation-name: fade;
                animation-duration: 1.5s;
            }

            @-webkit-keyframes fade {
                from {
                    opacity: .4
                }
                to {
                    opacity: 1
                }
            }

            @keyframes fade {
                from {
                    opacity: .4
                }
                to {
                    opacity: 1
                }
            }


        </style>

        <div class="ContainerIndent">

            <div class="Container50 Responsive">
                <h:form id="formLista" style="width: 99%;">
                    <p:panel styleClass="fondoPaneles">
                        <f:facet name="header">
                            <p:outputPanel style="display: block" styleClass="left Wid50">
                                <p:inputText maxlength="100" placeholder="#{labelName.placeholderBuscar}"
                                             styleClass="Wid50" autocomplete="off"
                                             value="#{usuarioTerceroBackBean.txtBuscar}"/>
                                <p:commandButton  icon="fa fa-search" styleClass="teal-btn"  value="#{labelName.btnBuscar}"
                                                 update="formLista" action="#{usuarioTerceroBackBean.cargarLista}"/>
                            </p:outputPanel>
                            <p:outputPanel style="display: block" styleClass="right">
                                <p:commandButton icon="fa fa-plus-circle" styleClass="cyan-btn" value="#{labelName.btnAgregar}"
                                                 update=":formDetalle"
                                                 action="#{usuarioTerceroBackBean.limpiar}"
                                                 resetValues="true"/>
                                <p:commandButton  icon="fa fa-pencil-square-o" styleClass="green-btn"  value="#{labelName.btnEditar}"
                                                 update=":formDetalle" action="#{usuarioTerceroBackBean.editar}"
                                                 resetValues="true"/>
                                <p:commandButton  icon="fa fa-pencil-square-o" styleClass="green-btn"  value="Enviar correo"
                                                 update=":formDetalle" action="#{usuarioTerceroBackBean.enviarCorreo}"
                                                 resetValues="true"/>

                                <p:commandButton  icon="fa fa-search" styleClass="teal-btn"  value="Ver Expediente" resetValues="true"
                                                 update=":tabViewCustom"
                                                 actionListener="#{usuarioTerceroBackBean.abrilModal}"/>
                            </p:outputPanel>
                        </f:facet>
                        <p:outputPanel styleClass="maxHeight tableClass">
                            <p:dataTable var="r"
                                         value="#{usuarioTerceroBackBean.listaUsuarios}"
                                         scrollable="false"
                                         scrollHeight="397"
                                         paginatorPosition="top"
                                         selectionMode="single"
                                         selection="#{usuarioTerceroBackBean.selectedRow}"
                                         rowKey="#{r.get('id')}"
                                         paginator="true"
                                         emptyMessage="#{labelName.tableEmptyMessage}"
                                         rows="11"
                                         pageLinks="3"
                                         paginatorTemplate="#{configApplicationBean.paginatorTemplate}"
                                         currentPageReportTemplate="#{configApplicationBean.currentPageReportTemplate}">

                                <!-- Evento doble click sobre una fila -->
                                <p:ajax event="rowSelect" listener="#{usuarioTerceroBackBean.editar}"
                                        update=":formDetalle"
                                        resetValues="true"/>

                                <p:column headerText="Usuario" styleClass="Wid20">
                                    <h:outputText value="#{r.get('username')}"/>
                                </p:column>

                                <p:column headerText="Nombre del Establecimiento" styleClass="Wid60">
                                    <h:outputText value="#{r.get('nombre_establecimiento')}"/>
                                </p:column>

                                <p:column headerText="Departamento/Municipio" styleClass="Wid60">
                                    <h:outputText value="#{r.get('departamento')}/#{r.get('municipio')}"/>
                                </p:column>

                                <p:column headerText="Pasivo" styleClass="Wid10 TexAlCenter">
                                    <p:selectBooleanCheckbox value="#{r.get('pasivo')}" disabled="true"
                                                             styleClass="ui-linus-enabled"/>
                                </p:column>

                            </p:dataTable>
                        </p:outputPanel>
                    </p:panel>
                </h:form>
            </div>

            <div class="Container50 Responsive">
                <h:form id="formDetalle" style="width: 100%;">
                    <p:tab id="tabDatos" title="Datos Generales">
                        <p:panel style="height: 545px" id="datosG">
                            <f:facet name="header">
                                <h:outputText value="ID: #{usuarioTerceroBackBean.hfId}"
                                              rendered="#{!usuarioTerceroBackBean.nuevoRegistro}"/>

                                <p:outputPanel style="display: block" styleClass="right">
                                    <p:commandButton icon="fa fa-save" styleClass="green-btn" value="#{labelName.btnGuardar}"
                                                     actionListener="#{usuarioTerceroBackBean.guardar}"/>

                                    <p:commandButton icon="fa fa-ban" styleClass="orange-btn"
                                                     value="#{labelName.btnCancelar}"
                                                     actionListener="#{usuarioTerceroBackBean.limpiar}"
                                                     update=":formDetalle"
                                                     immediate="true"
                                                     resetValues="true" process="@this"/>

                                </p:outputPanel>
                            </f:facet>
                            <h:panelGrid columns="2" styleClass="Wid100" columnClasses="Wid30, Wid70">

                                <p:outputLabel for="nombres" value="Nombres (Empresa Turística):"/>

                                <p:outputPanel style="display: block;width: 92%" styleClass="Wid80">
                                    <p:inputText maxlength="50" id="nombres" styleClass="Wid90"
                                                 label="Nombres" readonly="true" style="width: 87%"
                                                 required="true"
                                                 autocomplete="off"
                                                 value="#{usuarioTerceroBackBean.txtNombres}"/>
                                    <p:commandButton  icon="fa fa-search" styleClass="teal-btn"
                                                     rendered="#{usuarioTerceroBackBean.nuevoRegistro}"
                                                     type="image" immediate="true"
                                                     action="#{usuarioTerceroBackBean.cargarListaEmpresasTuristicas}"
                                                     update=":dlgAgregarEmpresaTuristica"/>
                                </p:outputPanel>

                                <p:outputLabel for="apellidos" value="Apellidos (Razón Social):"/>
                                <p:inputText maxlength="50" id="apellidos" styleClass="Wid90"
                                             value="#{usuarioTerceroBackBean.txtApellidos}"
                                             autocomplete="off" readonly="true"
                                             label="Apellidos" required="true"/>


                                <!--<p:outputLabel>Empresa turística:</p:outputLabel>-->
                                <!--<p:outputPanel style="display: block;width: 92%" styleClass="Wid80">-->
                                <!--<p:inputText placeholder="Seleccione una empresa turística" id="txtEmpresaTuristica"-->
                                <!--style="width: 87%"-->
                                <!--readonly="true" required="true"-->
                                <!--value="#{usuarioTerceroBackBean.txtEmpresaSeleccionadad}"/>-->
                                <!--<p:commandButton  icon="fa fa-search" styleClass="teal-btn" -->
                                <!--rendered="#{usuarioTerceroBackBean.nuevoRegistro}"-->
                                <!--type="image" immediate="true"-->
                                <!--action="#{usuarioTerceroBackBean.cargarListaEmpresasTuristicas}"-->
                                <!--update=":dlgAgregarEmpresaTuristica"/>-->
                                <!--</p:outputPanel>-->


                                <p:outputLabel for="username" value="Usuario:"/>
                                <p:outputPanel>
                                    <p:outputLabel rendered="#{usuarioTerceroBackBean.nuevoRegistro}"
                                                   style="padding-right: 11px;"
                                                   value="#{usuarioTerceroBackBean.txtPrefijoUsername}"/>
                                    <p:inputText id="username"
                                                 maxlength="30"
                                                 autocomplete="off"
                                                 styleClass="width90" label="Usuario" required="true"
                                                 value="#{usuarioTerceroBackBean.txtUsername}"
                                                 disabled="#{!usuarioTerceroBackBean.nuevoRegistro}">
                                        <f:validateRegex pattern="#{usuarioTerceroBackBean.regExpUsername}"/>
                                    </p:inputText>
                                </p:outputPanel>

                                <!--<p:outputLabel for="nombres" value="Nombres:"/>-->
                                <!--<p:inputText maxlength="50" id="nombres" styleClass="Wid90"-->
                                <!--label="Nombres" readonly="true"-->
                                <!--required="true"-->
                                <!--autocomplete="off"-->
                                <!--value="#{usuarioTerceroBackBean.txtNombres}"/>-->

                                <!--<p:outputLabel for="apellidos" value="Apellidos:"/>-->
                                <!--<p:inputText maxlength="50" id="apellidos" styleClass="Wid90"-->
                                <!--value="#{usuarioTerceroBackBean.txtApellidos}"-->
                                <!--autocomplete="off" readonly="true"-->
                                <!--label="Apellidos" required="true"/>-->

                                <p:outputLabel for="email" value="E-mail:"/>
                                <p:inputText maxlength="100" id="email" styleClass="Wid90"
                                             autocomplete="off" readonly="true"
                                             value="#{usuarioTerceroBackBean.txtEmail}"
                                             label="E-mail" required="true"/>

                                <p:outputLabel for="telefono" value="Teléfono:"/>
                                <p:inputText maxlength="100" id="telefono" styleClass="Wid90"
                                             autocomplete="off" readonly="true"
                                             value="#{usuarioTerceroBackBean.txtTelefono}"
                                             label="E-mail" required="true"/>
                                <p:outputLabel for="pasivo" value="Pasivo:"
                                               rendered="#{!usuarioTerceroBackBean.nuevoRegistro}"/>
                                <p:selectBooleanButton onLabel="Si" offLabel="No" id="pasivo"
                                                       value="#{usuarioTerceroBackBean.rbPasivo}"
                                                       rendered="#{!usuarioTerceroBackBean.nuevoRegistro}"/>
                            </h:panelGrid>

                            <p:keyFilter for="username" regEx="/#{usuarioTerceroBackBean.regExpUsername}/"/>

                            <h3 style="margin-top:0;padding-left: 5px;">Contraseña</h3>
                            <p:separator/>

                            <h:panelGrid id="tipoClaveSeleccion" columns="3" styleClass="Wid100"
                                         columnClasses="Wid30,Wid40,Wid30">

                                <p:outputLabel for="tipoClave" value="Tipo:"/>
                                <p:selectOneMenu id="tipoClave" style="width: 84%;" label="Tipo Clave:"
                                                 value="#{usuarioTerceroBackBean.somTipoGeneracionClave}">
                                    <f:selectItem itemLabel="Seleccione un tipo de clave" itemValue="#{null}"/>
                                    <f:selectItem itemLabel="Manual" itemValue="manual"/>
                                    <f:selectItem itemLabel="Aleatoria" itemValue="aleatoria"/>
                                    <p:ajax update="formDetalle:claveGenerada formDetalle:tipoClaveSeleccion"
                                            event="change"
                                            listener="#{usuarioTerceroBackBean.seleccionarTipoGeneracionClave}"/>
                                </p:selectOneMenu>

                                <p:commandButton icon="fa fa-refresh" id="btnClave"
                                                 update="labelClave cambiarClave "
                                                 immediate="true"
                                                 action="#{usuarioTerceroBackBean.generarClaveTemporal}"
                                                 rendered="#{usuarioTerceroBackBean.esClaveAleatoria}"/>

                                <p:outputLabel rendered="#{!usuarioTerceroBackBean.esClaveAleatoria}"/>

                            </h:panelGrid>

                            <h:panelGrid id="claveGenerada" columns="2" styleClass="Wid100"
                                         columnClasses="Wid30,Wid70">

                                <p:outputLabel value="Clave Aleatoria Generada:"
                                               rendered="#{usuarioTerceroBackBean.esClaveAleatoria}"/>

                                <p:outputLabel id="labelClave" value="#{usuarioTerceroBackBean.pwContraseña}"
                                               rendered="#{usuarioTerceroBackBean.esClaveAleatoria}"/>

                                <p:outputLabel for="cambiarClave" value="Clave:"
                                               rendered="#{usuarioTerceroBackBean.esClaveManual}"/>
                                <p:password id="cambiarClave" styleClass="Wid50"
                                            autocomplete="off" redisplay="true"
                                            maxlength="20"
                                            feedback="true"
                                            promptLabel="Ingrese una contraseña"
                                            weakLabel="Debil"
                                            goodLabel="Buena"
                                            strongLabel="Excelente"
                                            match="claveConfirmacion"
                                            value="#{usuarioTerceroBackBean.pwContraseña}"
                                            label="Clave" rendered="#{usuarioTerceroBackBean.esClaveManual}">
                                    <p:keyFilter regEx="/#{indexBackBean.regExpClave}/"/>
                                </p:password>
                                <p:outputLabel for="claveConfirmacion" value="Confirmación Clave:"
                                               rendered="#{usuarioTerceroBackBean.esClaveManual}"/>

                                <p:password id="claveConfirmacion" styleClass="Wid50"
                                            autocomplete="off" redisplay="true"
                                            maxlength="20"
                                            feedback="true"
                                            promptLabel="Ingrese una contraseña"
                                            weakLabel="Debil"
                                            goodLabel="Buena"
                                            strongLabel="Excelente"
                                            value="#{usuarioTerceroBackBean.pwConfirmacionContraseña}"
                                            label="Clave Confirmación"
                                            rendered="#{usuarioTerceroBackBean.esClaveManual}">
                                    <p:keyFilter regEx="/#{indexBackBean.regExpClave}/"/>
                                </p:password>

                                <p:outputLabel for="claveTemporal" value="Clave Temporal"
                                               rendered="#{usuarioTerceroBackBean.esClaveManual}"/>
                                <p:selectBooleanButton id="claveTemporal" onLabel="Si" offLabel="No"
                                                       rendered="#{usuarioTerceroBackBean.esClaveManual}"
                                                       value="#{usuarioTerceroBackBean.sbbClaveTemporal}">
                                    <p:ajax listener="#{usuarioTerceroBackBean.seleccionEnClaveTemporal}"/>
                                </p:selectBooleanButton>
                            </h:panelGrid>
                        </p:panel>
                    </p:tab>
                </h:form>
            </div>
        </div>

        <p:dialog id="dlgAgregarEmpresaTuristica" width="90%" height="481" widgetVar="wvDlgAgregarEmpresaTuristica" responsive="true"
                  modal="true" resizable="false" maximizable="false">
            <h:form id="formularioAgregarEmpresaTuristica">
                <p:panel>
                    <f:facet name="header">
                        <p:outputPanel style="display: block" styleClass="left">
                            <h:outputText value="Empresa turística"/>
                        </p:outputPanel>
                        <p:outputPanel style="display: block" styleClass="right">
                            <p:commandButton  icon="fa fa-pencil-square-o" styleClass="green-btn"
                                             value="Seleccionar"
                                             action="#{usuarioTerceroBackBean.seleccionandoEmpresaTuristica}"
                                             update=":formDetalle "
                                             oncomplete="PF('wvDlgAgregarEmpresaTuristica').hide()"/>
                        </p:outputPanel>
                    </f:facet>
                    <p:outputPanel>
                        <p:dataTable var="ars"
                                     id="listaAgregarEmpresaTuristica" widgetVar="listaAgregarEmpresaTuristica"
                                     value="#{usuarioTerceroBackBean.listaEmpresasTuristicas}"
                                     paginatorPosition="top"
                                     scrollHeight="300"
                                     scrollable="false"
                                     selectionMode="single"
                                     pageLinks="3"
                                     paginator="true"
                                     selection="#{usuarioTerceroBackBean.seleccionandoEmpresaTuristica}"
                                     rowKey="#{ars.get('id')}"
                                     emptyMessage="#{labelName.tableEmptyMessage}"
                                     rows="10"
                                     paginatorTemplate="#{configApplicationBean.paginatorTemplate}"
                                     currentPageReportTemplate="#{configApplicationBean.currentPageReportTemplate}">

                            <p:column headerText="Actividad" styleClass="Wid10"
                                      filterBy="#{ars.get('actividad_nombre')}"
                                      filterMatchMode="contains">
                                <h:outputText value="#{ars.get('actividad_nombre')}"/>
                            </p:column>

                            <p:column headerText="Nombre establecimiento" styleClass="Wid20"
                                      filterBy="#{ars.get('nombre_establecimiento')}"
                                      filterMatchMode="contains">
                                <h:outputText value="#{ars.get('nombre_establecimiento')}"/>
                            </p:column>

                            <p:column headerText="Razón social" styleClass="Wid20" filterBy="#{ars.get('razon_social')}"
                                      filterMatchMode="contains">
                                <h:outputText value="#{ars.get('razon_social')}"/>
                            </p:column>

                            <p:column headerText="RUC" styleClass="Wid10" filterBy="#{ars.get('no_ruc')}"
                                      filterMatchMode="contains">
                                <h:outputText value="#{ars.get('no_ruc')}"/>
                            </p:column>

                            <p:column headerText="Declara" styleClass="Wid10"
                                      filterMatchMode="contains" style="text-align: center">
                                <p:selectBooleanCheckbox value="#{ars.get('declara')}" disabled="true"
                                                         styleClass="ui-linus-enabled"/>
                            </p:column>


                        </p:dataTable>
                    </p:outputPanel>
                </p:panel>
            </h:form>
        </p:dialog>


        <p:dialog id="modalEmpresasDetalle" widgetVar="modal"
                  modal="true" resizable="false" closable="false"
                  width="98%" height="630">
            <p:tabView id="tabViewCustom" activeIndex="#{usuarioTerceroBackBean.indiceTabActivo}">
                <p:ajax event="tabChange" listener="#{usuarioTerceroBackBean.onTabChange}"/>


                <p:tab title="Datos generales">
                    <ui:include src="/web/views/expedienteET/parcialDatosCustomGeneralesView.xhtml">
                        <ui:param name="parcialCustomDatosGeneralesBackBean"
                                  value="#{parcialDatosGeneralesCustomBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabFuerzaLaboal" title="Fuerza laboral"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabFuerzaLaboral}">
                    <ui:include src="/web/views/expedienteET/parcialCustomFuerzaLaboralView.xhtml">
                        <ui:param name="parcialCustomFuerzaLaboralBackBean"
                                  value="#{parcialCustomFuerzaLaboralBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabEmpresasTuristicaDatosContacto" title="Datos de contactos"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabDatosContacto}">
                    <ui:include src="/web/views/expedienteET/parcialCustomDatosContactosView.xhtml">
                        <ui:param name="parcialCustomDatosContactosBackBean"
                                  value="#{parcialCustomDatosContactosBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaSA" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaSA}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaSAView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaSABackBean"
                                  value="#{parcialCustomCapacidadInstaladaSABackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaSABECN" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaSABECN}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaSABECNView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaSABECNBackBean"
                                  value="#{parcialCustomCapacidadInstaladaSABECNBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaOVETTT" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaOVETTT}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaOVETTTView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaOVETTTBackBean"
                                  value="#{parcialCustomCapacidadInstaladaOVETTTBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaETTA" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaETTA}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaETTAView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaETTABackBean"
                                  value="#{parcialCustomCapacidadInstaladaETTABackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaRA" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaRA}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaRAView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaRABackBean"
                                  value="#{parcialCustomCapacidadInstaladaRABackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaCC" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaCC}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaCCView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaCCBackBean"
                                  value="#{parcialCustomCapacidadInstaladaCCBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaLA" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaLA}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaLAView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaLABackBean"
                                  value="#{parcialCustomCapacidadInstaladaLABackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaAV" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaAV}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaAVView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaAVBackBean"
                                  value="#{parcialCustomCapacidadInstaladaAVBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabCapacidadInstaladaHC" title="Capacidad instalada"
                       styleClass="fondoPaneles"
                       rendered="#{usuarioTerceroBackBean.renderTabCapacidadInstaladaHC}">
                    <ui:include
                            src="/web/views/expedienteET/parcialCustomCapacidadInstaladaHCView.xhtml">
                        <ui:param name="parcialCustomCapacidadInstaladaHCBackBean"
                                  value="#{parcialCustomCapacidadInstaladaHCBackBean}"/>
                    </ui:include>
                </p:tab>

                <p:tab id="TabMapa" title="Mapa" styleClass="fondoPaneles">
                    <h:form id="formMapaEmpresa">
                        <p:remoteCommand name="rcImagenesEmpresa"
                                         actionListener="#{usuarioTerceroBackBean.cargarImagenesPorEmpresa}"/>
                        <p:panel id="panelMapa" style="height: 580px">
                            <f:facet name="header">
                                <p:outputPanel style="display: block" styleClass="right">
                                    <p:commandButton icon="fa fa-close" styleClass="blue-grey-btn"  value="Cerrar"
                                                     immediate="true"
                                                     onclick="PF('modal').hide()">
                                    </p:commandButton>
                                </p:outputPanel>
                            </f:facet>
                            <p:panel id="map" style="height: 485px"/>
                        </p:panel>
                    </h:form>
                </p:tab>

                <p:tab id="TabImagenes" title="Fotos" styleClass="fondoPaneles">
                    <h:form id="formSubirImagenes">
                        <p:panel id="panelImgenes" styleClass="fondoPaneles" style="height: 580px">
                            <f:facet name="header">
                                <p:outputPanel style="display: block" styleClass="right">
                                    <p:commandButton icon="fa fa-close" styleClass="blue-grey-btn"  value="Cerrar"
                                                     immediate="true"
                                                     onclick="PF('modal').hide()">
                                    </p:commandButton>
                                </p:outputPanel>
                            </f:facet>
                            <h:panelGrid columns="1" columnClasses="Wid100" styleClass="Wid100"
                                         style="margin-bottom: 5px">
                                <p:dataGrid var="car"
                                            value="#{parcialDatosGeneralesCustomBackBean.listaImagenes}"
                                            columns="4" layout="grid"
                                            rows="4" paginator="true" id="cars"
                                            paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

                                    <p:panel style="text-align:center">
                                        <h:panelGrid columns="1" style="width:100%">
                                            <p:graphicImage id="imagen"
                                                            value="#{parcialDatosGeneralesCustomBackBean.rutaArchivo}#{car.nombreArchivo}"
                                                            height="200" width="170"/>
                                        </h:panelGrid>

                                    </p:panel>
                                </p:dataGrid>

                            </h:panelGrid>
                        </p:panel>
                    </h:form>
                </p:tab>

            </p:tabView>
        </p:dialog>
        <!--  Redes Sociales   -->
        <p:dialog id="modalRedSocial" widgetVar="modalRedSocial" modal="true" closable="true" draggable="false"
                  resizable="false" width="50%" height="300px" style="min-width: 500px !important;">

            <h:form id="formRedSocial" style="width: 100%;">
                <p:panel id="contenedorRedSocial" styleClass="fondoPaneles">
                    <f:facet name="header">

                        <p:outputPanel style="display: block" styleClass="left Wid50">Redes Sociales</p:outputPanel>

                    </f:facet>

                    <p:dataTable var="dtRedSocial" id="dtRedSocial"
                                 widgetVar="dtRedSocial"
                                 value="#{parcialDatosGeneralesCustomBackBean.listMapRedSocialET}"
                                 rowKey="#{dtRedSocial.id}"
                                 selectionMode="single"
                                 emptyMessage="#{labelName.tableEmptyMessage}"
                                 reflow="true"
                                 scrollable="false"
                                 scrollHeight="150"
                                 paginator="true"
                                 paginatorPosition="top"
                                 rows="5"
                                 pageLinks="5"
                                 paginatorTemplate="#{configApplicationBean.paginatorTemplate}">

                        <p:column headerText="Red Social" style="width: 35%">
                            <h:outputText value="#{dtRedSocial.tipo_red_social}"/>
                        </p:column>

                        <p:column headerText="URL" style="width: 65%">
                            <h:outputText value="#{dtRedSocial.url}"/>
                        </p:column>

                    </p:dataTable>
                </p:panel>
            </h:form>
        </p:dialog>


        <!--  Datos de Ubicación   -->
        <p:dialog id="modalDatosUbicacion" widgetVar="modalDatosUbicacion" modal="true" closable="true"
                  draggable="false"
                  resizable="false" width="60%" height="220px" style="min-width: 500px !important;">

            <h:form id="formDatosUbicacion" style="width: 100%;">
                <p:panel id="contenedorDatosUbicacion" styleClass="fondoPaneles">
                    <f:facet name="header">

                        <p:outputPanel style="display: block" styleClass="left Wid50">Datos de Ubicación</p:outputPanel>

                    </f:facet>
                    <p:panelGrid columns="4" styleClass="panelModificado"
                                 columnClasses="ui-grid-col-2,ui-grid-col-3,ui-grid-col-2,ui-grid-col-5"
                                 layout="grid">
                        <p:outputLabel for="delegacion" value="Delegación:"/>
                        <p:inputText autocomplete="off"
                                     id="delegacion"
                                     style="width: 60%; text-transform: none!important; background-color: #F7E3A4; color: #000000;"
                                     disabled="true"
                                     label="delegacion"
                                     value="#{parcialDatosGeneralesCustomBackBean.oET.delegacionId.entidadId.nombre}">
                        </p:inputText>

                        <p:outputLabel for="municipio" value="Municipio:"/>
                        <p:inputText autocomplete="off"
                                     id="municipio"
                                     style="width: 60%; text-transform: none!important; background-color: #F7E3A4; color: #000000;"
                                     disabled="true"
                                     label="municipio"
                                     value="#{parcialDatosGeneralesCustomBackBean.oET.delegacionId.nombre}">
                        </p:inputText>

                    </p:panelGrid>

                    <p:panelGrid columns="2" styleClass="panelModificado"
                                 columnClasses="ui-grid-col-2,ui-grid-col-10"
                                 layout="grid">
                        <p:outputLabel id="direc" for="direccionE"
                                       value="#{parcialDatosGeneralesCustomBackBean.oET.clasificacionesId.id != 7 ?'Dirección de la empresa:':'Dirección domiciliar:'}"/>
                        <p:inputText id="direccionE"
                                     style="width: 99%"
                                     label="Dirección de la empresa"
                                     disabled="true"
                                     value="#{parcialDatosGeneralesCustomBackBean.oET.direccion}">
                        </p:inputText>
                    </p:panelGrid>

                    <p:panelGrid columns="4" styleClass="panelModificado"
                                 columnClasses="ui-grid-col-2,ui-grid-col-3,ui-grid-col-2,ui-grid-col-5"
                                 layout="grid">
                        <p:outputLabel for="latitudLoc" value="Latitud:"/>
                        <p:inputText autocomplete="off"
                                     id="latitudLoc"
                                     style="width: 30%; text-transform: none!important; background-color: #F7E3A4; color: #000000;"
                                     disabled="true"
                                     label="latitudLoc"
                                     value="#{parcialDatosGeneralesCustomBackBean.oET.latitud}">
                        </p:inputText>

                        <p:outputLabel for="longitudLoc" value="Longitud:"/>
                        <p:inputText autocomplete="off"
                                     id="longitudLoc"
                                     style="width: 30%; text-transform: none!important; background-color: #F7E3A4; color: #000000;"
                                     disabled="true"
                                     label="longitudLoc"
                                     value="#{parcialDatosGeneralesCustomBackBean.oET.longitud}">
                        </p:inputText>
                    </p:panelGrid>

                </p:panel>
            </h:form>
        </p:dialog>

        <!--  Mapa   -->
        <script type="application/javascript">
            //<![CDATA[
            var map;
            var slideIndex = 1;

            function limpiarMapa() {
                map.remove();
            }

            function actualizarMedidas() {
                // 1.
                map.invalidateSize();
                // 2. prueba modificando los milisegundos
                //setTimeout(function () {
                //    map.invalidateSize();
                //}, 500);
            }

            function mapa(valores) {
                var SplitValores = valores.split("+++");

                // Declaracion de las leyendas
                var mbAttr = "Instituto Nicaragüense de Turismo - INTUR www.mapanicaragua.com";
                //Mapa
                var mbMapView = 'https://sig.intur.gob.ni/osm/{z}/{x}/{y}.png';
                // var mbCarl = 'https://a.tile.openstreetmap.org/{z}/{x}/{y}.png';
                var northEast = new L.LatLng(6.65673828125, -97.30810546875);
                var southWest = new L.LatLng(19.05126953125, -75.265625);

                var bounds = new L.LatLngBounds(southWest, northEast);

                map = L.map('tabViewCustom:formMapaEmpresa:map').setView([SplitValores[7], SplitValores[8]], 17);

                L.tileLayer(mbMapView, {
                    attribution: mbAttr,
                    bounds: bounds,
                    minZoom: 16,
                    maxZoom: 20
                }).addTo(map);

                map.setMaxBounds(bounds);

                L.marker([SplitValores[7], SplitValores[8]], {
                    customId: SplitValores[0],
                    icon: L.ExtraMarkers.icon({
                        icon: '',
                        markerColor: 'blue',
                        shape: 'circle',
                        prefix: 'fa'
                    })
                }).bindPopup(
                    '<table>' +
                    '<tr><td style="text-align: center" colspan="2" id="verimgd"><div class="slideshow-container" id="contenedor"></div></td></tr>' +
                    '<tr><td style="width: 23%"><strong>Nombre:</strong></td><td>' + SplitValores[1] + ' </td></tr>' +
                    '<tr><td><strong>Actividad:</strong></td><td>' + SplitValores[2] + ' </td></tr>' +
                    '<tr><td><strong>Categoría:</strong></td><td>' + SplitValores[3] + ' </td></tr>' +
                    '<tr><td><strong>Dirección:</strong></td><td>' + SplitValores[4] + ' </td></tr>' +
                    '<tr><td><strong>Teléfono:</strong></td><td>' + SplitValores[5] + '</td></tr>' +
                    '<tr><td><strong>Correo:</strong></td><td><a href="mailto:' + SplitValores[6] + '">' + SplitValores[6] + '</a></td></tr></table>' +
                    '<table style="width: 100%"><tr>' +
                    '<td><strong>Lat:</strong></td><td>' + SplitValores[7] + '</td>' +
                    '<td><strong> Long:</strong></td><td>' + SplitValores[8] + '</td></tr> ' +
                    '<tr><td><strong>Facebook:</strong></td><td><a href="' + SplitValores[9] + '" target="_blank">' + SplitValores[9] + '</a></td></tr>' +
                    '<tr><td><strong>Twitter:</strong></td><td><a href="' + SplitValores[10] + '" target="_blank">' + SplitValores[11] + '</a></td></tr>' +
                    '<tr><td><strong>Instagram:</strong></td><td><a href="' + SplitValores[11] + '" target="_blank">' + SplitValores[10] + '</a></td></tr>' +
                    '</table>'
                ).addTo(map).on("click", onClickMarker);

            }

            function onClickMarker(e) {
                rcImagenesEmpresa([{name: 'ids', value: this.options.customId}]);
            }

            function plusSlides(n) {
                showSlides(slideIndex += n);
            }

            function currentSlide(n) {
                showSlides(slideIndex = n);
            }
            //]]>
        </script>
    </ui:define>

</ui:composition>
